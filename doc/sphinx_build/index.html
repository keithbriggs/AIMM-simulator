
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>AIMM simulator documentation &#8212; AIMM simulator 2.0.0 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">AIMM simulator 2.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="aimm-simulator-documentation">
<h1>AIMM simulator documentation<a class="headerlink" href="#aimm-simulator-documentation" title="Permalink to this headline">¶</a></h1>
<p>Last modified: 2022-11-14T10:53</p>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>The AIMM simulator emulates a cellular radio system roughly following 5G concepts and channel models.   The intention is to have an easy-to-use and fast system written in pure Python with minimal dependencies. It is especially designed to be suitable for interfacing to AI engines such as <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code> or <code class="docutils literal notranslate"><span class="pre">pytorch</span></code>, and it is not a principal aim for it to be extremely accurate at the level of the radio channel. The simulator was developed for the <a class="reference external" href="https://aimm.celticnext.eu">AIMM project</a>.</p>
</div>
<div class="section" id="software-prerequisites">
<h2>Software prerequisites<a class="headerlink" href="#software-prerequisites" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><a class="reference external" href="https://python.org">Python 3.8 or higher</a>.</li>
<li><a class="reference external" href="https://numpy.org/">NumPy</a>. This normally comes with python distributions.</li>
<li><a class="reference external" href="https://pypi.org/project/simpy/">Simpy</a>.   This will need to be installed, e.g. with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">simpy</span></code>.</li>
<li>If real-time plotting is needed, <a class="reference external" href="https://matplotlib.org">matplotlib</a>, with an appropriate backend such as PyQt5 (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">PyQt5</span></code>).</li>
</ol>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Downloading the wheel (typically <code class="docutils literal notranslate"><span class="pre">dist/aimm_simulator-2.0.0-py3-none-any.whl</span></code>) and running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">&lt;wheel&gt;</span></code> should be all that is needed.</p>
<p>After the install, test it with <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">examples/basic_test.py</span></code>.</p>
<p>Note that a plotting utility <code class="docutils literal notranslate"><span class="pre">src/realtime_plotter.py</span></code> is included but not installed.  If needed, this script should be placed somewhere in your python path.
A folder <code class="docutils literal notranslate"><span class="pre">img</span></code> is used by the examples to save plots in png and pdf format.  So in order to run the examples with plotting, this folder must be created.</p>
<p>The documentation can be built from the sources with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">doc</span></code>.</p>
</div>
<div class="section" id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>The following example will test the installation and introduce the basic concepts.  This creates a simulator instance <code class="docutils literal notranslate"><span class="pre">sim</span></code>, creates one cell, creates one UE and immediately attaches it to the cell, and runs for 100 seconds of simulated time (typically about 0.03 seconds of run time).  There is no logger defined, which means there will be no output apart from a few set-up messages (which are sent to stderr).  The code is in <code class="docutils literal notranslate"><span class="pre">AIMM_simulator_example_n0.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">AIMM_simulator</span> <span class="kn">import</span> <span class="n">Sim</span>
<span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
<span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">()</span>
<span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">()</span><span class="o">.</span><span class="n">attach_to_nearest_cell</span><span class="p">()</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>The basic steps to build and run a simulation are:</p>
<ol class="arabic simple">
<li>Create a <code class="docutils literal notranslate"><span class="pre">Sim</span></code> instance.</li>
<li>Create one or more cells with <code class="docutils literal notranslate"><span class="pre">make_cell()</span></code>. Cells are given a unique index, starting from 0.</li>
<li>Create one or more UEs with <code class="docutils literal notranslate"><span class="pre">make_UE()</span></code>. UEs are given a unique index, starting from 0.</li>
<li>Attach UEs with the method <code class="docutils literal notranslate"><span class="pre">attach_to_nearest_cell()</span></code>.</li>
<li>Create a <code class="docutils literal notranslate"><span class="pre">Scenario</span></code>, which typically moves the UEs according to some mobility model, but in general can include any events which affect the network.</li>
<li>Create one or more instances of <code class="docutils literal notranslate"><span class="pre">Logger</span></code>.</li>
<li>Optionally create a <code class="docutils literal notranslate"><span class="pre">RIC</span></code>, possibly linking to an AI engine.</li>
<li>Start the simulation with <code class="docutils literal notranslate"><span class="pre">sim.run()</span></code>.</li>
<li>Plot or analyse the results in the logfiles.</li>
</ol>
<p>The AIMM simulator uses a discrete event simulation framework.    Internally, a queue of pending events is maintained, but this is invisible to the programmer.
All functions and classes have default arguments appropriate to the simulation of a 5G macrocell deployment at 3.5GHz.  This means that setting up a simple simulation is almost trivial, but also means that care is needed to set parameters correctly for other scenarios.  Subbanding is implemented on all <code class="docutils literal notranslate"><span class="pre">Cell</span></code> objects, but the number of subbands may be set to 1, effectively switching off this feature.</p>
<p>The AIMM simulator normally operates without a graphical user interface, and just writes logfiles for subsequent analysis.   The default logfile format is tab-separated columns, with purely numerical data.  These files can then be easily processed with shell utilities such as <code class="docutils literal notranslate"><span class="pre">cut</span></code>, <code class="docutils literal notranslate"><span class="pre">head</span></code>, <code class="docutils literal notranslate"><span class="pre">tail</span></code>, etc., or read into python or R scripts, or, if all else fails, even imported into spreadsheet programs.  However, a custom logger can create a logfile in any desired format.</p>
</div>
<div class="section" id="aimm-simulator-blocks">
<h2>AIMM simulator blocks<a class="headerlink" href="#aimm-simulator-blocks" title="Permalink to this headline">¶</a></h2>
<div class="figure" id="id1">
<a class="reference internal image-reference" href="_images/AIMM_Simulator_block_diagram.png"><img alt="AIMM simulator block diagram" src="_images/AIMM_Simulator_block_diagram.png" style="width: 869.5px; height: 470.5px;" /></a>
<p class="caption"><span class="caption-text">AIMM simulator block structure.</span></p>
</div>
</div>
<div class="section" id="tutorial-examples">
<h2>Tutorial examples<a class="headerlink" href="#tutorial-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>This example (the code is in <code class="docutils literal notranslate"><span class="pre">AIMM_simulator_example_n1.py</span></code>) creates a simulator instance, creates one cell, creates four UEs and immediately attaches them to the cell, adds a default logger, and runs for 100 seconds of simulated time.  UEs by default are placed randomly in a 1km square.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">AIMM_simulator</span> <span class="kn">import</span> <span class="n">Sim</span><span class="p">,</span><span class="n">Logger</span>
<span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
<span class="n">cell</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">()</span>
<span class="n">ues</span><span class="o">=</span><span class="p">[</span><span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">()</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="n">sim</span><span class="o">.</span><span class="n">add_logger</span><span class="p">(</span><span class="n">Logger</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">logging_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>Typical output follows.   The locations are 3-dimensional, with the z component being the antenna height.   The default logger prints 3 columns to stdout, with a row for each UE report: cell index, UE index, CQI value.  We will see later how to create a custom logger.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Cell[0] is at [434.44 591.64  20.  ]
UE[0]   is at [602.14 403.7    2.  ]
UE[1]   is at [263.87 301.28   2.  ]
UE[2]   is at [319.12 506.63   2.  ]
UE[3]   is at [370.7  394.92   2.  ]
KDTree built.
Sim: starting main loop for simulation time 100 seconds...
0     0       15
0     1       15
0     2       15
0     3       15
...
Sim: finished main loop in 0.04 seconds.
</pre></div>
</div>
</div>
<div class="section" id="example-2-adding-a-scenario">
<h3>Example 2 - adding a scenario<a class="headerlink" href="#example-2-adding-a-scenario" title="Permalink to this headline">¶</a></h3>
<p>A scenario is created by subclassing the <code class="docutils literal notranslate"><span class="pre">Scenario</span></code> class. The code is in <code class="docutils literal notranslate"><span class="pre">AIMM_simulator_example_n2.py</span></code>.  The subclass must implement the <code class="docutils literal notranslate"><span class="pre">loop</span></code> method as in the example: it must have an infinite loop, yielding an <code class="docutils literal notranslate"><span class="pre">s.sim.wait()</span></code> object, which determines the time to the next event; in this case the next change to the UE positions.  In this example, an MME is also added.   This handles UE handovers, and ensures that UEs are always attached to the nearest cell.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">standard_normal</span>

<span class="k">class</span> <span class="nc">MyScenario</span><span class="p">(</span><span class="n">Scenario</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">ue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">:</span> <span class="n">ue</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">example_n2</span><span class="p">():</span>
  <span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
  <span class="n">cell</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">()</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_logger</span><span class="p">(</span><span class="n">Logger</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">logging_interval</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_scenario</span><span class="p">(</span><span class="n">MyScenario</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_MME</span><span class="p">(</span><span class="n">MME</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">10.0</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">example_n2</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
</div>
<div class="section" id="example-3-adding-a-custom-logger">
<h3>Example 3 - adding a custom logger<a class="headerlink" href="#example-3-adding-a-custom-logger" title="Permalink to this headline">¶</a></h3>
<p>There are two ways to create a custom logger.   The simplest way is to specify a function when creating the Logger instance. This function must accept two arguments, the Sim instance and the file object to write to. Example code for this method is in <code class="docutils literal notranslate"><span class="pre">AIMM_simulator_example_n3a.py</span></code>. The custom logger must format a line of output, and write it to the file object <code class="docutils literal notranslate"><span class="pre">f</span></code>.  Access to all simulation variables is possible; see the API documentation below. A convenience function <code class="docutils literal notranslate"><span class="pre">np_array_to_str</span></code> is available, which removes square brackets and commas from normal numpy array formatting.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">standard_normal</span><span class="p">,</span><span class="n">seed</span>

<span class="k">def</span> <span class="nf">scenario_func</span><span class="p">(</span><span class="n">sim</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">ue</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">:</span> <span class="n">ue</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">example_n3a</span><span class="p">():</span>
  <span class="k">def</span> <span class="nf">logger_func</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">ue_i</span> <span class="ow">in</span> <span class="n">cell</span><span class="o">.</span><span class="n">reports</span><span class="p">[</span><span class="s1">&#39;cqi&#39;</span><span class="p">]:</span>
        <span class="n">xy</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">get_UE_position</span><span class="p">(</span><span class="n">ue_i</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">tp</span><span class="o">=</span><span class="n">np_array_to_str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">get_UE_throughput</span><span class="p">(</span><span class="n">ue_i</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">cell</span><span class="o">.</span><span class="n">i</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">ue_i</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">tp</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span> <span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">()</span><span class="o">.</span><span class="n">attach_to_nearest_cell</span><span class="p">()</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_logger</span><span class="p">(</span><span class="n">Logger</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">func</span><span class="o">=</span><span class="n">logger_func</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;#time</span><span class="se">\t</span><span class="s1">cell</span><span class="se">\t</span><span class="s1">UE</span><span class="se">\t</span><span class="s1">x</span><span class="se">\t</span><span class="s1">y</span><span class="se">\t</span><span class="s1">throughput Mb/s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">logging_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_scenario</span><span class="p">(</span><span class="n">Scenario</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">func</span><span class="o">=</span><span class="n">scenario_func</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_MME</span><span class="p">(</span><span class="n">MME</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">10.0</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">example_n3a</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>More generally, a custom logger can be created by subclassing the <code class="docutils literal notranslate"><span class="pre">Logger</span></code> class.   The subclass must implement the <code class="docutils literal notranslate"><span class="pre">loop</span></code> method as in the example: it must have an infinite loop, yielding an <code class="docutils literal notranslate"><span class="pre">s.sim.wait()</span></code> object, which determines the time to the next write to the logfile (which defaults to stdout). The custom logger must format a line of output, and write it to the file object <code class="docutils literal notranslate"><span class="pre">self.f</span></code>. Example code for this method is in <code class="docutils literal notranslate"><span class="pre">AIMM_simulator_example_n3.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">standard_normal</span><span class="p">,</span><span class="n">seed</span>

<span class="k">class</span> <span class="nc">MyScenario</span><span class="p">(</span><span class="n">Scenario</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">ue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">:</span> <span class="n">ue</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyLogger</span><span class="p">(</span><span class="n">Logger</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#time</span><span class="se">\t</span><span class="s1">cell</span><span class="se">\t</span><span class="s1">UE</span><span class="se">\t</span><span class="s1">x</span><span class="se">\t</span><span class="s1">y</span><span class="se">\t</span><span class="s1">throughput</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ue_i</span> <span class="ow">in</span> <span class="n">cell</span><span class="o">.</span><span class="n">reports</span><span class="p">[</span><span class="s1">&#39;cqi&#39;</span><span class="p">]:</span>
          <span class="n">xy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">get_UE_position</span><span class="p">(</span><span class="n">ue_i</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
          <span class="n">tp</span><span class="o">=</span><span class="n">np_array_to_str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">get_UE_throughput</span><span class="p">(</span><span class="n">ue_i</span><span class="p">))</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="se">\t</span><span class="s1">cell=</span><span class="si">{</span><span class="n">cell</span><span class="o">.</span><span class="n">i</span><span class="si">}</span><span class="se">\t</span><span class="s1">UE=</span><span class="si">{</span><span class="n">ue_i</span><span class="si">}</span><span class="se">\t</span><span class="s1">x=</span><span class="si">{</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\t</span><span class="s1">y=</span><span class="si">{</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\t</span><span class="s1">tp=</span><span class="si">{</span><span class="n">tp</span><span class="si">}</span><span class="s1">Mb/s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_interval</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">example_n3</span><span class="p">():</span>
  <span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span> <span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">()</span><span class="o">.</span><span class="n">attach_to_nearest_cell</span><span class="p">()</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_logger</span><span class="p">(</span><span class="n">MyLogger</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">logging_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_scenario</span><span class="p">(</span><span class="n">MyScenario</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_MME</span><span class="p">(</span><span class="n">MME</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">10.0</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">example_n3</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>Typical output is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>#time cell    UE      x       y       throughput Mb/s
0.0   0       5       618     694     6.63
0.0   0       7       435     549     1.17
0.0   1       1       709     593     13.26
0.0   2       0       395     405     0.98
0.0   2       2       567     266     2.65
0.0   2       3       718     496     0.61
0.0   2       4       484     346     2.65
0.0   2       6       310     377     0.61
1.0   0       5       616     694     6.63
1.0   0       7       437     548     1.17
1.0   1       1       710     592     13.26
1.0   2       0       395     406     0.98
1.0   2       2       566     264     2.05
1.0   2       3       719     497     0.61
1.0   2       4       484     347     2.65
1.0   2       6       312     377     0.61
</pre></div>
</div>
</div>
<div class="section" id="example-4-adding-a-ric">
<h3>Example 4 - adding a RIC<a class="headerlink" href="#example-4-adding-a-ric" title="Permalink to this headline">¶</a></h3>
<p>A RIC (radio intelligent controller) is an agent able to control any aspect of a cell configuration in real time.  This toy example illustrates the detection of the UE with the lowest throughout (<code class="docutils literal notranslate"><span class="pre">throughputs[0][1]</span></code>, after the sort), and allocates a new subband to the cell serving that UE.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">standard_normal</span><span class="p">,</span><span class="n">seed</span>

<span class="k">class</span> <span class="nc">MyScenario</span><span class="p">(</span><span class="n">Scenario</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">ue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">:</span> <span class="n">ue</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyLogger</span><span class="p">(</span><span class="n">Logger</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#time</span><span class="se">\t</span><span class="s1">cell</span><span class="se">\t</span><span class="s1">UE</span><span class="se">\t</span><span class="s1">x</span><span class="se">\t</span><span class="s1">y</span><span class="se">\t</span><span class="s1">throughput</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ue_i</span> <span class="ow">in</span> <span class="n">cell</span><span class="o">.</span><span class="n">reports</span><span class="p">[</span><span class="s1">&#39;cqi&#39;</span><span class="p">]:</span>
          <span class="n">xy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">get_UE_position</span><span class="p">(</span><span class="n">ue_i</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
          <span class="n">tp</span><span class="o">=</span><span class="n">np_array_to_str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">get_UE_throughput</span><span class="p">(</span><span class="n">ue_i</span><span class="p">))</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;t=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="se">\t</span><span class="s1">cell=</span><span class="si">{</span><span class="n">cell</span><span class="o">.</span><span class="n">i</span><span class="si">}</span><span class="se">\t</span><span class="s1">UE=</span><span class="si">{</span><span class="n">ue_i</span><span class="si">}</span><span class="se">\t</span><span class="s1">x=</span><span class="si">{</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\t</span><span class="s1">y=</span><span class="si">{</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\t</span><span class="s1">tp=</span><span class="si">{</span><span class="n">tp</span><span class="si">}</span><span class="s1">Mb/s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_interval</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyRIC</span><span class="p">(</span><span class="n">RIC</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">throughputs</span><span class="o">=</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">ue</span><span class="o">.</span><span class="n">serving_cell</span><span class="o">.</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_UE_throughput</span><span class="p">(</span><span class="n">ue</span><span class="o">.</span><span class="n">i</span><span class="p">),</span><span class="n">ue</span><span class="o">.</span><span class="n">i</span><span class="p">,)</span> <span class="k">for</span> <span class="n">ue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">]</span>
      <span class="n">throughputs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
      <span class="n">mask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">[</span><span class="n">throughputs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">serving_cell</span><span class="o">.</span><span class="n">subband_mask</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">bit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bit</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
          <span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
          <span class="k">break</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">example_n4</span><span class="p">():</span>
  <span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span> <span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span> <span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">()</span><span class="o">.</span><span class="n">attach_to_nearest_cell</span><span class="p">()</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_logger</span><span class="p">(</span><span class="n">MyLogger</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">logging_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_scenario</span><span class="p">(</span><span class="n">MyScenario</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_MME</span><span class="p">(</span><span class="n">MME</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">10.0</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_ric</span><span class="p">(</span><span class="n">MyRIC</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">10.0</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">example_n4</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
</div>
<div class="section" id="example-5-adding-an-antenna-radiation-pattern">
<h3>Example 5 - adding an antenna radiation pattern<a class="headerlink" href="#example-5-adding-an-antenna-radiation-pattern" title="Permalink to this headline">¶</a></h3>
<p>In this example there are two cells, and one UE which is driven around a circle centred on Cell[0] by the MyScenario class. There is no MME, so no handovers occur. With omnidirectional antennas, the UE would be exactly at the cell edge at times which are multiples of 100 seconds.   But with the pattern implemented for Cell[0] in line 29, the antenna has a beam pointing east, towards the interfering cell (Cell[1], which remains omnidirectional).  This considerable improves the average throughput.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span><span class="n">sin</span><span class="p">,</span><span class="n">pi</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="kn">from</span> <span class="nn">AIMM_simulator</span> <span class="kn">import</span> <span class="n">Sim</span><span class="p">,</span><span class="n">Scenario</span><span class="p">,</span><span class="n">Logger</span><span class="p">,</span><span class="n">to_dB</span>

<span class="k">class</span> <span class="nc">MyScenario</span><span class="p">(</span><span class="n">Scenario</span><span class="p">):</span>
  <span class="c1"># move the UE around a circle of specified radius, period T seconds</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mf">100.0</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
      <span class="k">for</span> <span class="n">ue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">:</span>
        <span class="n">ue</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">radius</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="p">),</span><span class="n">radius</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyLogger</span><span class="p">(</span><span class="n">Logger</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ue_i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s1">&#39; log for UE[ue_i] only, from reports sent to Cell[0]. &#39;</span>
    <span class="n">cell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">UE</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">[</span><span class="n">ue_i</span><span class="p">]</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">tm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>              <span class="c1"># current time</span>
      <span class="n">xy</span><span class="o">=</span><span class="n">UE</span><span class="o">.</span><span class="n">get_xyz</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>              <span class="c1"># current UE position</span>
      <span class="n">tp</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">get_UE_throughput</span><span class="p">(</span><span class="n">ue_i</span><span class="p">)</span>  <span class="c1"># current UE throughput</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">tm</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">tp</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_interval</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">example_n5</span><span class="p">():</span>
  <span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
  <span class="n">pattern</span><span class="o">=</span><span class="k">lambda</span> <span class="n">angle</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">+</span><span class="n">to_dB</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">angle</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)))</span>
  <span class="n">cell0</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="p">[</span>  <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">20.0</span><span class="p">],</span><span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">)</span>
  <span class="n">cell1</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="mf">200.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">20.0</span><span class="p">])</span>
  <span class="n">ue</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="p">[</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">])</span>
  <span class="n">ue</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">cell0</span><span class="p">)</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_logger</span><span class="p">(</span><span class="n">MyLogger</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">logging_interval</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_scenario</span><span class="p">(</span><span class="n">MyScenario</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">example_n5</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>A typical command to run this using the real-time plotter would be:</p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">AIMM_simulator_example_n5.py</span> <span class="pre">|</span> <span class="pre">./realtime_plotter_05.py</span> <span class="pre">-np=3</span> <span class="pre">-tm=500</span> <span class="pre">-ylims='{0:</span> <span class="pre">(-100,100),</span> <span class="pre">1:</span> <span class="pre">(-100,100),</span> <span class="pre">2:</span> <span class="pre">(0,45)}'</span> <span class="pre">-ylabels='{0:</span> <span class="pre">&quot;UE[0]</span> <span class="pre">$x$&quot;,</span> <span class="pre">1:</span> <span class="pre">&quot;UE[0]</span> <span class="pre">$y$&quot;,</span> <span class="pre">2:</span> <span class="pre">&quot;UE[0]</span> <span class="pre">throughput&quot;}'</span> <span class="pre">-fnb='img/AIMM_simulator_example_n5'</span></code>.</p>
<p>This generates a plot like this:</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/AIMM_simulator_example_n5.png"><img alt="AIMM_simulator_example_n5.png" src="_images/AIMM_simulator_example_n5.png" style="width: 768.0px; height: 575.2px;" /></a>
</div>
</div>
<div class="section" id="example-6-a-hetnet-heterogeneous-network-with-macro-and-small-cells">
<h3>Example 6 - a hetnet (heterogeneous network) with macro and small cells<a class="headerlink" href="#example-6-a-hetnet-heterogeneous-network-with-macro-and-small-cells" title="Permalink to this headline">¶</a></h3>
<p>In this example we start with 9 macro-cells in a 3x3 grid arrangement (line 30).  We then drop 50 UEs at random into the system (line 32), and start the simulation (there is no UE mobility). The logger just computes the average throughput over all UEs. The scenario has these discrete events:</p>
<ol class="arabic simple">
<li>At time 20, 20 small cells at random locations are added to the system  (line 8).  There is a drop in average throughput because the new cells just generate interference and are not yet used as serving cells.</li>
<li>At time 40, the UEs are reattached to the best cell (line 11).  Now throughput improves to above the initial value, because some UEs are now served by a nearby small cell.</li>
<li>At time 60, subband masks are applied to make the macro and small cells non-interfering.  Macro cells are given 1/4 of the channel bandwidth (line 15), and the small cells have 3/4 of the channel bandwidth (line 17).   Now throughput improves further.   As this subband allocation will not be optimal, further improvement will still be possible.</li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">stderr</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="kn">from</span> <span class="nn">AIMM_simulator</span> <span class="kn">import</span> <span class="n">Sim</span><span class="p">,</span><span class="n">Logger</span><span class="p">,</span><span class="n">Scenario</span>

<span class="k">class</span> <span class="nc">MyScenario</span><span class="p">(</span><span class="n">Scenario</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># wait 20 seconds</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">(</span><span class="n">power_dBm</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">n_subbands</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;small cells added at t=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">stderr</span><span class="p">)</span>
    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># wait 20 seconds</span>
    <span class="k">for</span> <span class="n">UE</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">:</span> <span class="n">UE</span><span class="o">.</span><span class="n">attach_to_strongest_cell_simple_pathloss_model</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;UEs reattached at t=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">stderr</span><span class="p">)</span>
    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># wait 20 seconds</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>      <span class="c1"># set subband mask for macro cells</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_subband_mask</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">29</span><span class="p">):</span>   <span class="c1"># set subband mask for small cells</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_subband_mask</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cells masked at t=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">stderr</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyLogger</span><span class="p">(</span><span class="n">Logger</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># log average throughput over all UEs</span>
      <span class="n">ave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">get_average_throughput</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">ave</span><span class="si">:</span><span class="s1">.4</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_interval</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">hetnet</span><span class="p">():</span>
  <span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="p">(</span><span class="mf">1000.0</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span><span class="mf">1000.0</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="p">),</span><span class="mf">20.0</span><span class="p">),</span><span class="n">power_dBm</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span><span class="n">n_subbands</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">()</span><span class="o">.</span><span class="n">attach_to_strongest_cell_simple_pathloss_model</span><span class="p">()</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_logger</span><span class="p">(</span><span class="n">MyLogger</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">logging_interval</span><span class="o">=</span><span class="mf">1.0e-1</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_scenario</span><span class="p">(</span><span class="n">MyScenario</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">hetnet</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>The command</p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">AIMM_simulator_example_n6.py</span> <span class="pre">|</span> <span class="pre">./realtime_plotter_03.py</span> <span class="pre">-np=1</span> <span class="pre">-tm=100</span> <span class="pre">-ylims='(0,0.25)'</span> <span class="pre">-ylabels='{0:</span> <span class="pre">&quot;average</span> <span class="pre">downlink</span> <span class="pre">throughput</span> <span class="pre">over</span> <span class="pre">all</span> <span class="pre">UEs&quot;}'</span> <span class="pre">-fnb='img/AIMM_simulator_example_n6'</span></code></p>
<p>then generates a plot like this:</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/AIMM_simulator_example_n6.png"><img alt="AIMM_simulator_example_n6.png" src="_images/AIMM_simulator_example_n6.png" style="width: 768.0px; height: 575.2px;" /></a>
</div>
</div>
<div class="section" id="example-7-a-hetnet-with-mobility">
<h3>Example 7 - a hetnet with mobility<a class="headerlink" href="#example-7-a-hetnet-with-mobility" title="Permalink to this headline">¶</a></h3>
<p>This is similar to example 6, but now an MME is added to perform handovers for the mobile UEs.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span><span class="n">standard_normal</span>
<span class="kn">from</span> <span class="nn">AIMM_simulator</span> <span class="kn">import</span> <span class="n">Sim</span><span class="p">,</span><span class="n">Logger</span><span class="p">,</span><span class="n">Scenario</span><span class="p">,</span><span class="n">MME</span><span class="p">,</span><span class="n">np_array_to_str</span>

<span class="k">class</span> <span class="nc">MyScenario</span><span class="p">(</span><span class="n">Scenario</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">ue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">:</span> <span class="n">ue</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="mi">20</span><span class="o">*</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyLogger</span><span class="p">(</span><span class="n">Logger</span><span class="p">):</span>
  <span class="c1"># throughput of UE[0], UE[0] position, serving cell index</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">sc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">serving_cell</span><span class="o">.</span><span class="n">i</span>
      <span class="n">tp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span><span class="o">.</span><span class="n">get_UE_throughput</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="n">xy0</span><span class="o">=</span><span class="n">np_array_to_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">tp</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">xy0</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">sc</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_interval</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">hetnet</span><span class="p">(</span><span class="n">n_subbands</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
  <span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span> <span class="c1"># macros</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="p">(</span><span class="mf">500.0</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span><span class="mf">500.0</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="p">),</span><span class="mf">20.0</span><span class="p">),</span><span class="n">power_dBm</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span><span class="n">n_subbands</span><span class="o">=</span><span class="n">n_subbands</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="c1"># small cells</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">(</span><span class="n">power_dBm</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">n_subbands</span><span class="o">=</span><span class="n">n_subbands</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">()</span><span class="o">.</span><span class="n">attach_to_strongest_cell_simple_pathloss_model</span><span class="p">()</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xyz</span><span class="p">([</span><span class="mf">500.0</span><span class="p">,</span><span class="mf">500.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">])</span>
  <span class="k">for</span> <span class="n">UE</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">:</span> <span class="n">UE</span><span class="o">.</span><span class="n">attach_to_strongest_cell_simple_pathloss_model</span><span class="p">()</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_logger</span><span class="p">(</span><span class="n">MyLogger</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">logging_interval</span><span class="o">=</span><span class="mf">1.0</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_scenario</span><span class="p">(</span><span class="n">MyScenario</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_MME</span><span class="p">(</span><span class="n">MME</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">50.0</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>

<span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">hetnet</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>The command</p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">AIMM_simulator_example_n7.py</span> <span class="pre">|</span> <span class="pre">./realtime_plotter_03.py</span> <span class="pre">-np=4</span> <span class="pre">-tm=2000</span> <span class="pre">-ylims='{0:</span> <span class="pre">(0,10),</span> <span class="pre">1:</span> <span class="pre">(0,1000),</span> <span class="pre">2:</span> <span class="pre">(0,1000),</span> <span class="pre">3:</span> <span class="pre">(0,30)}'</span> <span class="pre">-ylabels='{0:</span> <span class="pre">&quot;UE[0]</span> <span class="pre">throughput&quot;,</span> <span class="pre">1:</span> <span class="pre">&quot;UE[0]</span> <span class="pre">$x$&quot;,</span> <span class="pre">2:</span> <span class="pre">&quot;UE[0]</span> <span class="pre">$y$&quot;,</span> <span class="pre">3:</span> <span class="pre">&quot;UE[0]</span> <span class="pre">serving</span> <span class="pre">cell&quot;}'</span> <span class="pre">-fnb='img/AIMM_simulator_example_n7'</span></code></p>
<p>then generates a plot like this:</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/AIMM_simulator_example_n7.png"><img alt="AIMM_simulator_example_n7.png" src="_images/AIMM_simulator_example_n7.png" style="width: 768.0px; height: 575.2px;" /></a>
</div>
</div>
<div class="section" id="example-8-estimating-cqi-distribution">
<h3>Example 8 - estimating CQI distribution<a class="headerlink" href="#example-8-estimating-cqi-distribution" title="Permalink to this headline">¶</a></h3>
<p>This is similar to example 7, but now we create a histogram at the end of the simulation, rather than using real-time plotting.  A MIMO gain boost is added half-way through the simulation, in order to observe the effect on the CQI values at UE[0].  This example also illustrates the use of the <code class="docutils literal notranslate"><span class="pre">finalize</span></code> function, to create the histograms after the simulation has finished.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span><span class="n">sin</span><span class="p">,</span><span class="n">pi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span><span class="n">standard_normal</span>
<span class="kn">from</span> <span class="nn">AIMM_simulator</span> <span class="kn">import</span> <span class="n">Sim</span><span class="p">,</span><span class="n">Logger</span><span class="p">,</span><span class="n">Scenario</span><span class="p">,</span><span class="n">MME</span>

<span class="k">class</span> <span class="nc">MyScenario</span><span class="p">(</span><span class="n">Scenario</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span><span class="n">circle</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span> 
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ue</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">circle</span> <span class="ow">and</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="c1"># walk UE[0] around a circle</span>
          <span class="n">t</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span>
          <span class="n">ue</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">500</span><span class="o">+</span><span class="n">radius</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="p">),</span><span class="mi">500</span><span class="o">+</span><span class="n">radius</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># random walk, mean speed=1</span>
          <span class="n">ue</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">1.414</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Histogram_Logger</span><span class="p">(</span><span class="n">Logger</span><span class="p">):</span>
  <span class="c1"># CQI histogram for UE[0]</span>
  <span class="n">h_cqi0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
  <span class="n">h_cqi1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ue0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">until</span><span class="p">:</span>
      <span class="n">sc</span><span class="o">=</span><span class="n">ue0</span><span class="o">.</span><span class="n">get_serving_cell</span><span class="p">()</span>
      <span class="n">cqi</span><span class="o">=</span><span class="n">ue0</span><span class="o">.</span><span class="n">get_CQI</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">cqi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_cqi0</span><span class="p">[</span><span class="n">cqi</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+=</span><span class="mi">1</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_interval</span><span class="p">)</span>
    <span class="c1"># half-time break - boost MIMO gain of all cells</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
      <span class="n">cell</span><span class="o">.</span><span class="n">set_MIMO_gain</span><span class="p">(</span><span class="mf">6.0</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
      <span class="n">sc</span><span class="o">=</span><span class="n">ue0</span><span class="o">.</span><span class="n">get_serving_cell</span><span class="p">()</span>
      <span class="n">cqi</span><span class="o">=</span><span class="n">ue0</span><span class="o">.</span><span class="n">get_CQI</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">cqi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_cqi1</span><span class="p">[</span><span class="n">cqi</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+=</span><span class="mi">1</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logging_interval</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">finalize</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">hs</span><span class="o">=</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">h_cqi0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">h_cqi0</span><span class="p">),</span><span class="n">s</span><span class="o">.</span><span class="n">h_cqi1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">h_cqi1</span><span class="p">))</span>
    <span class="n">plot_histograms</span><span class="p">(</span><span class="n">hs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_histograms</span><span class="p">(</span><span class="n">hs</span><span class="p">,</span><span class="n">fn</span><span class="o">=</span><span class="s1">&#39;examples/img/AIMM_simulator_example_n8&#39;</span><span class="p">):</span>
  <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
  <span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Rectangle</span>
  <span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">PatchCollection</span>
  <span class="kn">from</span> <span class="nn">fig_timestamp</span> <span class="kn">import</span> <span class="n">fig_timestamp</span>
  <span class="n">ymax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">)</span>
  <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;CQI for UE[0]&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;relative frequency&#39;</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="o">*</span><span class="n">ymax</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">fc</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">hs</span><span class="p">,(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">),(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">PatchCollection</span><span class="p">([</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mf">0.2</span><span class="p">,</span><span class="n">hi</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">hi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">h</span><span class="p">)],</span><span class="n">facecolor</span><span class="o">=</span><span class="n">fc</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;blue: normal</span><span class="se">\n</span><span class="s1">red: after 6dB MIMO gain boost&#39;</span><span class="p">,(</span><span class="mi">7</span><span class="p">,</span><span class="mf">0.97</span><span class="o">*</span><span class="n">ymax</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round,pad=1&#39;</span><span class="p">))</span>
  <span class="n">fig_timestamp</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">author</span><span class="o">=</span><span class="s1">&#39;Keith Briggs&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">fc</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">hs</span><span class="p">,(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">),):</span>
    <span class="n">mean</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">hi</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">hi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">h</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;rarrow,pad=0.1&#39;</span><span class="p">,</span><span class="n">fc</span><span class="o">=</span><span class="n">fc</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="n">fc</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fn</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span><span class="p">)</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fn</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">example_n8</span><span class="p">():</span>
  <span class="n">sim</span><span class="o">=</span><span class="n">Sim</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>  <span class="c1"># cells</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">make_cell</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="o">+</span><span class="mf">200.0</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span><span class="mi">300</span><span class="o">+</span><span class="mf">200.0</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="p">),</span><span class="mf">10.0</span><span class="p">),</span><span class="n">power_dBm</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span> <span class="c1"># UEs</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">make_UE</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">attach_to_strongest_cell_simple_pathloss_model</span><span class="p">()</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xyz</span><span class="p">([</span><span class="mf">503.0</span><span class="p">,</span><span class="mf">507.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">])</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">UEs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">attach_to_strongest_cell_simple_pathloss_model</span><span class="p">()</span>
  <span class="n">logger</span><span class="o">=</span><span class="n">Histogram_Logger</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">logging_interval</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_logger</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_scenario</span><span class="p">(</span><span class="n">MyScenario</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">add_MME</span><span class="p">(</span><span class="n">MME</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">interval</span><span class="o">=</span><span class="mf">20.0</span><span class="p">))</span>
  <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mi">5000</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
  <span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">example_n8</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>The command</p>
<p><code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">AIMM_simulator_example_n8.py</span></code></p>
<p>then generates a plot like this:</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/AIMM_simulator_example_n8.png"><img alt="AIMM_simulator_example_n8.png" src="_images/AIMM_simulator_example_n8.png" style="width: 640.0px; height: 640.0px;" /></a>
</div>
</div>
</div>
<div class="section" id="using-the-geometry-3d-module">
<h2>Using the geometry_3d module<a class="headerlink" href="#using-the-geometry-3d-module" title="Permalink to this headline">¶</a></h2>
<p>This module is provided for running indoor simulations, and takes account of wall adsorptions, but not reflections or diffraction.  It is not a full ray-tracing code.  The main task it performs is to compute intersections of signal paths with walls, and it is optimized to be fast for this application. An example of usage is below.</p>
<p>More details on usage to be added here.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geometry_3d</span> <span class="kn">import</span> <span class="n">block</span><span class="p">,</span><span class="n">Panel</span><span class="p">,</span><span class="n">Building</span><span class="p">,</span><span class="n">Ray</span><span class="p">,</span><span class="n">draw_building</span>
<span class="n">blk0</span><span class="o">=</span><span class="n">block</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">blk1</span><span class="o">=</span><span class="n">block</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">blk2</span><span class="o">=</span><span class="n">block</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">blk3</span><span class="o">=</span><span class="n">block</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">blk4</span><span class="o">=</span><span class="n">block</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">16.5</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">fence</span><span class="o">=</span><span class="n">Panel</span><span class="p">([</span><span class="n">Triangle</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>
             <span class="n">Triangle</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">1</span><span class="p">))])</span>
<span class="n">b</span><span class="o">=</span><span class="n">Building</span><span class="p">(</span><span class="n">blk0</span><span class="o">+</span><span class="n">blk1</span><span class="o">+</span><span class="n">blk2</span><span class="o">+</span><span class="n">blk3</span><span class="o">+</span><span class="n">blk4</span><span class="o">+</span><span class="p">(</span><span class="n">fence</span><span class="p">,))</span>
<span class="n">ray0</span><span class="o">=</span><span class="n">Ray</span><span class="p">((</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">2.0</span><span class="p">),(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.01</span><span class="p">))</span>
<span class="n">line_segments</span><span class="o">=</span><span class="p">[(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">),(</span><span class="mi">18</span><span class="p">,</span><span class="mi">18</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)]</span> <span class="c1"># [xs,ys,zs]</span>
<span class="n">draw_building</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">rays</span><span class="o">=</span><span class="p">[</span><span class="n">ray0</span><span class="p">],</span><span class="n">line_segments</span><span class="o">=</span><span class="n">line_segments</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">limits</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span><span class="s1">&#39;$z$&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">pdffn</span><span class="o">=</span><span class="s1">&#39;building0.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This constructs a building like this:</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/building0.png"><img alt="building0.png" src="_images/building0.png" style="width: 512.0px; height: 384.0px;" /></a>
</div>
</div>
<div class="section" id="using-the-real-time-plotting-utility">
<h2>Using the real-time plotting utility<a class="headerlink" href="#using-the-real-time-plotting-utility" title="Permalink to this headline">¶</a></h2>
<p>As an aid to development and debugging, a stand-alone python script <code class="docutils literal notranslate"><span class="pre">realtime_plotter_05.py</span></code> for real-time plotting is included.   This reads stdin and plots in a window as the data is generated.  By default, png and pdf images are saved when all data has been read.   It is configured with these command-line arguments:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-np      number of plots (default 1)
-tm      t_max (maximum time on x-axis, default 10)
-xl      x-axis label (default &#39;time&#39;)
-fst     final sleep time (before closing the window and saving the images)
-fnb     filename base
-ylims   y-axis limits (a python dictionary)
-ylabels y-axis labels (a python dictionary
-title   figure title
-lw      line width (default 2)
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">-fnb</span></code> is specifed, the final plot is saved as png and pdf figures.
Typical usage would be in a bash script like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span>python3 AIMM_simulator_RIC_example_01.py <span class="p">|</span> <span class="se">\</span>
   ./realtime_plotter_06a.py <span class="se">\</span>
   -author<span class="o">=</span><span class="s1">&#39;Keith Briggs&#39;</span> <span class="se">\</span>
   -nplots<span class="o">=</span><span class="m">7</span> <span class="se">\</span>
   -tmax<span class="o">=</span><span class="m">10000</span> <span class="se">\</span>
   -fst<span class="o">=</span><span class="m">30</span> <span class="se">\</span>
   -fnb<span class="o">=</span><span class="s1">&#39;img/AIMM_simulator_RIC_example&#39;</span> <span class="se">\</span>
   -ylims<span class="o">=</span><span class="s1">&#39;{0: (-100,100), 1: (-100,100), 2: (-1,16), 3: (-1,16), 4: (-1,16), 5: (0,50), 6: (0,9)}&#39;</span> <span class="se">\</span>
   -ylabels<span class="o">=</span><span class="s1">&#39;{0: &quot;$x$&quot;, 1: &quot;$y$&quot;, 2: &quot;CQI$_0$&quot;, 3: &quot;CQI$_1$&quot;, 4: &quot;CQI$_2$&quot;, 5: &quot;throughput&quot;, 6: &quot;serving cell&quot;}&#39;</span> <span class="se">\</span>
   -title <span class="s1">&#39;UE$_0$&#39;</span>
</pre></div></td></tr></table></div>
</div>
<p>This generates a plot like this:</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/AIMM_simulator_RIC_example.png"><img alt="AIMM_simulator_RIC_example.png" src="_images/AIMM_simulator_RIC_example.png" style="width: 768.0px; height: 575.2px;" /></a>
</div>
</div>
<div class="section" id="simulator-module-api-reference">
<h2>Simulator module API reference<a class="headerlink" href="#simulator-module-api-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-AIMM_simulator">
<span id="aimm-simulator"></span><h3>AIMM simulator<a class="headerlink" href="#module-AIMM_simulator" title="Permalink to this headline">¶</a></h3>
<p>The AIMM simulator emulates a cellular radio system roughly following 5G concepts and channel models.</p>
<dl class="class">
<dt id="AIMM_simulator.Sim">
<em class="property">class </em><code class="descclassname">AIMM_simulator.</code><code class="descname">Sim</code><span class="sig-paren">(</span><em>params={'fc_GHz': 3.5</em>, <em>'h_BS': 20.0</em>, <em>'h_UT': 2.0}</em>, <em>show_params=True</em>, <em>rng_seed=0</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing the complete simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> (<em>dict</em>) – A dictionary of additional global parameters which need to be accessible to downstream functions. In the instance, these parameters will be available as <code class="docutils literal notranslate"><span class="pre">sim.params</span></code>.  If <code class="docutils literal notranslate"><span class="pre">params['profile']</span></code> is set to a non-empty string, then a code profile will be performed and the results saved to the filename given by the string.  There will be some execution time overhead when profiling.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="AIMM_simulator.Sim.add_MME">
<code class="descname">add_MME</code><span class="sig-paren">(</span><em>mme</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.add_MME" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an MME instance to the simulation.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.add_logger">
<code class="descname">add_logger</code><span class="sig-paren">(</span><em>logger</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.add_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a logger to the simulation.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.add_loggers">
<code class="descname">add_loggers</code><span class="sig-paren">(</span><em>loggers</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.add_loggers" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a sequence of loggers to the simulation.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.add_ric">
<code class="descname">add_ric</code><span class="sig-paren">(</span><em>ric</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.add_ric" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a RIC instance to the simulation.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.add_scenario">
<code class="descname">add_scenario</code><span class="sig-paren">(</span><em>scenario</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.add_scenario" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a Scenario instance to the simulation.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.get_UE_position">
<code class="descname">get_UE_position</code><span class="sig-paren">(</span><em>ue_i</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.get_UE_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the xyz position of UE[i] in the simulation.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.get_average_throughput">
<code class="descname">get_average_throughput</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.get_average_throughput" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the average throughput over all UEs attached to all cells.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.get_best_rsrp_cell">
<code class="descname">get_best_rsrp_cell</code><span class="sig-paren">(</span><em>ue_i</em>, <em>dbg=False</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.get_best_rsrp_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the cell delivering the highest RSRP at UE[i].
Relies on UE reports, and <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned if there are not enough
reports (yet) to determine the desired output.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.get_ncells">
<code class="descname">get_ncells</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.get_ncells" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current number of cells in the simulation.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.get_nearest_cell">
<code class="descname">get_nearest_cell</code><span class="sig-paren">(</span><em>xy</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.get_nearest_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the geographical nearest cell (in 2 dimensions)
to the point xy.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.get_nues">
<code class="descname">get_nues</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.get_nues" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current number of UEs in the simulation.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.get_strongest_cell_simple_pathloss_model">
<code class="descname">get_strongest_cell_simple_pathloss_model</code><span class="sig-paren">(</span><em>xyz</em>, <em>alpha=3.5</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.get_strongest_cell_simple_pathloss_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the cell delivering the strongest signal
at the point xyz (in 3 dimensions), with pathloss exponent alpha.
Note: antenna pattern is not used, so this function is deprecated,
but is adequate for initial UE attachment.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.make_UE">
<code class="descname">make_UE</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.make_UE" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function: make a new UE instance and add it to the simulation; parameters as for the UE class. Return the new UE instance.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.make_cell">
<code class="descname">make_cell</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.make_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function: make a new Cell instance and add it to the simulation; parameters as for the Cell class. Return the new Cell instance.  It is assumed that Cells never move after being created (i.e. the initial xyz[1] stays the same throughout the simulation).</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Sim.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><em>interval=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Sim.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to avoid low-level reference to env.timeout().
<code class="docutils literal notranslate"><span class="pre">loop</span></code> functions in each class must yield this.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="AIMM_simulator.Cell">
<em class="property">class </em><code class="descclassname">AIMM_simulator.</code><code class="descname">Cell</code><span class="sig-paren">(</span><em>sim</em>, <em>interval=10.0</em>, <em>bw_MHz=10.0</em>, <em>n_subbands=1</em>, <em>xyz=None</em>, <em>h_BS=20.0</em>, <em>power_dBm=30.0</em>, <em>MIMO_gain_dB=0.0</em>, <em>pattern=None</em>, <em>f_callback=None</em>, <em>f_callback_kwargs={}</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing a single Cell (gNB).  As instances are created, the are automatically given indices starting from 0.  This index is available as the data member <code class="docutils literal notranslate"><span class="pre">cell.i</span></code>.   The variable <code class="docutils literal notranslate"><span class="pre">Cell.i</span></code> is always the current number of cells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sim</strong> (<a class="reference internal" href="#AIMM_simulator.Sim" title="AIMM_simulator.Sim"><em>Sim</em></a>) – Simulator instance which will manage this Cell.</li>
<li><strong>interval</strong> (<em>float</em>) – Time interval between Cell updates.</li>
<li><strong>bw_MHz</strong> (<em>float</em>) – Channel bandwidth in MHz.</li>
<li><strong>n_subbands</strong> (<em>int</em>) – Number of subbands.</li>
<li><strong>xyz</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>]</em>) – Position of cell in metres, and antenna height.</li>
<li><strong>h_BS</strong> (<em>float</em>) – Antenna height in metres; only used if xyz is not provided.</li>
<li><strong>power_dBm</strong> (<em>float</em>) – Transmit power in dBm.</li>
<li><strong>MIMO_gain_dB</strong> (<em>float</em>) – Effective power gain from MIMO in dB.  This is no more than a crude way to
estimate the performance gain from using MIMO.  A typical[1] might be 3dB for 2x2 MIMO.</li>
<li><strong>pattern</strong> (<em>array</em><em> or </em><em>function</em>) – If an array, then a 360-element array giving the antenna gain in dB in 1-degree increments (0=east, then counterclockwise).  Otherwise, a function giving the antenna gain in dB in the direction theta=(180/pi)*atan2(y,x).</li>
<li><strong>f_callback</strong> – A function with signature <code class="docutils literal notranslate"><span class="pre">f_callback(self,kwargs)</span></code>, which will be called
at each iteration of the main loop.</li>
<li><strong>verbosity</strong> (<em>int</em>) – Level of debugging output (0=none).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="AIMM_simulator.Cell.boost_power_dBm">
<code class="descname">boost_power_dBm</code><span class="sig-paren">(</span><em>p</em>, <em>mn=None</em>, <em>mx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.boost_power_dBm" title="Permalink to this definition">¶</a></dt>
<dd><p>Increase or decrease (if p&lt;0) the transmit power in dBm to be used by this cell.
If mn is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the power will not be set if it falls below mn.
If mx is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the power will not be set if it exceeds mx.
Return the new power.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_RSRP_reports">
<code class="descname">get_RSRP_reports</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_RSRP_reports" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current RSRP reports to this cell, as a list of tuples (ue.i, rsrp).</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_RSRP_reports_dict">
<code class="descname">get_RSRP_reports_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_RSRP_reports_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current RSRP reports to this cell, as a dictionary ue.i: rsrp.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_UE_CQI">
<code class="descname">get_UE_CQI</code><span class="sig-paren">(</span><em>ue_i</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_UE_CQI" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current CQI of UE[i] in the simulation, as an array across all subbands.  An array of NaNs is returned if there is no report.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_UE_throughput">
<code class="descname">get_UE_throughput</code><span class="sig-paren">(</span><em>ue_i</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_UE_throughput" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total current throughput in Mb/s of UE[i] in the simulation.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_average_throughput">
<code class="descname">get_average_throughput</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_average_throughput" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the average throughput over all UEs attached to this cell.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_nattached">
<code class="descname">get_nattached</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_nattached" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current number of UEs attached to this Cell.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_power_dBm">
<code class="descname">get_power_dBm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_power_dBm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the transmit power in dBm currently used by this cell.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_rsrp">
<code class="descname">get_rsrp</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_rsrp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return last RSRP reported to this cell by UE[i].</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_rsrp_history">
<code class="descname">get_rsrp_history</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_rsrp_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of the last 10 RSRP[1]s reported to this cell by UE[i].</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_subband_mask">
<code class="descname">get_subband_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_subband_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current subband mask.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.get_xyz">
<code class="descname">get_xyz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.get_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current position of this Cell.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.loop">
<code class="descname">loop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Main loop of Cell class.  Default: do nothing.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.set_MIMO_gain">
<code class="descname">set_MIMO_gain</code><span class="sig-paren">(</span><em>MIMO_gain_dB</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.set_MIMO_gain" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the MIMO gain in dB to be used by this cell.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.set_f_callback">
<code class="descname">set_f_callback</code><span class="sig-paren">(</span><em>f_callback</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.set_f_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a callack function to the main loop of this Cell</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.set_pattern">
<code class="descname">set_pattern</code><span class="sig-paren">(</span><em>pattern</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.set_pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the antenna radiation pattern.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.set_power_dBm">
<code class="descname">set_power_dBm</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.set_power_dBm" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the transmit power in dBm to be used by this cell.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.set_subband_mask">
<code class="descname">set_subband_mask</code><span class="sig-paren">(</span><em>mask</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.set_subband_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the subband mask to <code class="docutils literal notranslate"><span class="pre">mask</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Cell.set_xyz">
<code class="descname">set_xyz</code><span class="sig-paren">(</span><em>xyz</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Cell.set_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a new position for this Cell.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="AIMM_simulator.UE">
<em class="property">class </em><code class="descclassname">AIMM_simulator.</code><code class="descname">UE</code><span class="sig-paren">(</span><em>sim</em>, <em>xyz=None</em>, <em>reporting_interval=1.0</em>, <em>pathloss_model=None</em>, <em>h_UT=2.0</em>, <em>f_callback=None</em>, <em>f_callback_kwargs={}</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a single UE. As instances are created, the are automatically given indices starting from 0.  This index is available as the data member <code class="docutils literal notranslate"><span class="pre">ue.i</span></code>.   The static (class-level) variable <code class="docutils literal notranslate"><span class="pre">UE.i</span></code> is always the current number of UEs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sim</strong> (<a class="reference internal" href="#AIMM_simulator.Sim" title="AIMM_simulator.Sim"><em>Sim</em></a>) – The Sim instance which will manage this UE.</li>
<li><strong>xyz</strong> (<em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>]</em>) – Position of UE in metres, and antenna height.</li>
<li><strong>h_UT</strong> (<em>float</em>) – Antenna height of user terminal in metres; only used if xyz is not provided.</li>
<li><strong>reporting_interval</strong> (<em>float</em>) – Time interval between UE reports being sent to the serving cell.</li>
<li><strong>f_callback</strong> – A function with signature <code class="docutils literal notranslate"><span class="pre">f_callback(self,kwargs)</span></code>, which will be called at each iteration of the main loop.</li>
<li><strong>f_callback_kwargs</strong> – kwargs for previous function.</li>
<li><strong>pathloss_model</strong> – An instance of a pathloss model.  This must be a callable object which
takes two arguments, each a 3-vector.  The first represent the transmitter
location, and the second the receiver location.  It must return the
pathloss in dB along this signal path.
If set to <code class="docutils literal notranslate"><span class="pre">None</span></code> (the default), a standard urban macrocell model
is used.
See further <code class="docutils literal notranslate"><span class="pre">NR_5G_standard_functions_00.py</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="AIMM_simulator.UE.attach">
<code class="descname">attach</code><span class="sig-paren">(</span><em>cell</em>, <em>quiet=True</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.attach" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach this UE to a specific Cell instance.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.attach_to_nearest_cell">
<code class="descname">attach_to_nearest_cell</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.attach_to_nearest_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach this UE to the geographically nearest Cell instance.
Intended for initial attachment only.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.attach_to_strongest_cell_simple_pathloss_model">
<code class="descname">attach_to_strongest_cell_simple_pathloss_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.attach_to_strongest_cell_simple_pathloss_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach to the cell delivering the strongest signal
at the current UE position. Intended for initial attachment only.
Uses only a simple power-law pathloss model.  For proper handover
behaviour, use the MME module.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.detach">
<code class="descname">detach</code><span class="sig-paren">(</span><em>quiet=True</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.detach" title="Permalink to this definition">¶</a></dt>
<dd><p>Detach this UE from its serving cell.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.get_CQI">
<code class="descname">get_CQI</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.get_CQI" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current CQI of this UE, as an array across all subbands.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.get_serving_cell">
<code class="descname">get_serving_cell</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.get_serving_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current serving Cell object (not index) for this UE instance.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.get_serving_cell_i">
<code class="descname">get_serving_cell_i</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.get_serving_cell_i" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current serving Cell index for this UE instance.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.get_xyz">
<code class="descname">get_xyz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.get_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current position of this UE.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.loop">
<code class="descname">loop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Main loop of UE class</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.send_rsrp_reports">
<code class="descname">send_rsrp_reports</code><span class="sig-paren">(</span><em>threshold=-120.0</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.send_rsrp_reports" title="Permalink to this definition">¶</a></dt>
<dd><p>Send RSRP reports in dBm to all cells for which it is over the threshold.
Subbands not handled.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.send_subband_cqi_report">
<code class="descname">send_subband_cqi_report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.send_subband_cqi_report" title="Permalink to this definition">¶</a></dt>
<dd><p>For this UE, send an array of CQI reports, one for each subband; and a total throughput report, to the serving cell.
What is sent is a 2-tuple (current time, array of reports).
For RSRP reports, use the function <code class="docutils literal notranslate"><span class="pre">send_rsrp_reports</span></code>.
Also save the CQI[1]s in s.cqi, and return the throughput value.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.set_f_callback">
<code class="descname">set_f_callback</code><span class="sig-paren">(</span><em>f_callback</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.set_f_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a callack function to the main loop of this UE</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.UE.set_xyz">
<code class="descname">set_xyz</code><span class="sig-paren">(</span><em>xyz</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.UE.set_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a new position for this UE.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="AIMM_simulator.Scenario">
<em class="property">class </em><code class="descclassname">AIMM_simulator.</code><code class="descname">Scenario</code><span class="sig-paren">(</span><em>sim</em>, <em>func=None</em>, <em>interval=1.0</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Scenario" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for a simulation scenario. The default does nothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sim</strong> (<a class="reference internal" href="#AIMM_simulator.Sim" title="AIMM_simulator.Sim"><em>Sim</em></a>) – Simulator instance which will manage this Scenario.</li>
<li><strong>func</strong> (<em>function</em>) – Function called to perform actions.</li>
<li><strong>interval</strong> (<em>float</em>) – Time interval between actions.</li>
<li><strong>verbosity</strong> (<em>int</em>) – Level of debugging output (0=none).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="AIMM_simulator.Scenario.loop">
<code class="descname">loop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Scenario.loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Main loop of Scenario class.  Should be overridden to provide different functionalities.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="AIMM_simulator.MME">
<em class="property">class </em><code class="descclassname">AIMM_simulator.</code><code class="descname">MME</code><span class="sig-paren">(</span><em>sim</em>, <em>interval=10.0</em>, <em>strategy='strongest_cell_simple_pathloss_model'</em>, <em>anti_pingpong=30.0</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.MME" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a MME, for handling UE handovers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sim</strong> (<a class="reference internal" href="#AIMM_simulator.Sim" title="AIMM_simulator.Sim"><em>Sim</em></a>) – Sim instance which will manage this Scenario.</li>
<li><strong>interval</strong> (<em>float</em>) – Time interval between checks for handover actions.</li>
<li><strong>verbosity</strong> (<em>int</em>) – Level of debugging output (0=none).</li>
<li><strong>strategy</strong> (<em>str</em>) – Handover strategy; possible values are <code class="docutils literal notranslate"><span class="pre">strongest_cell_simple_pathloss_model</span></code> (default), or <code class="docutils literal notranslate"><span class="pre">best_rsrp_cell</span></code>.</li>
<li><strong>anti_pingpong</strong> (<em>float</em>) – If greater than zero, then a handover pattern x-&gt;y-&gt;x between cells x and y is not allowed within this number of seconds. Default is 0.0, meaning pingponging is not suppressed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="AIMM_simulator.MME.do_handovers">
<code class="descname">do_handovers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.MME.do_handovers" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether handovers are required, and do them if so.
Normally called from loop(), but can be called manually if required.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.MME.finalize">
<code class="descname">finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.MME.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Function called at end of simulation, to implement any required finalization actions.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.MME.loop">
<code class="descname">loop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.MME.loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Main loop of MME.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="AIMM_simulator.RIC">
<em class="property">class </em><code class="descclassname">AIMM_simulator.</code><code class="descname">RIC</code><span class="sig-paren">(</span><em>sim</em>, <em>interval=10</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.RIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for a RIC, for hosting xApps.  The default does nothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sim</strong> (<a class="reference internal" href="#AIMM_simulator.Sim" title="AIMM_simulator.Sim"><em>Sim</em></a>) – Simulator instance which will manage this Scenario.</li>
<li><strong>interval</strong> (<em>float</em>) – Time interval between RIC actions.</li>
<li><strong>verbosity</strong> (<em>int</em>) – Level of debugging output (0=none).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="AIMM_simulator.RIC.finalize">
<code class="descname">finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.RIC.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Function called at end of simulation, to implement any required finalization actions.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.RIC.loop">
<code class="descname">loop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.RIC.loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Main loop of RIC class.  Must be overridden to provide functionality.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="AIMM_simulator.Logger">
<em class="property">class </em><code class="descclassname">AIMM_simulator.</code><code class="descname">Logger</code><span class="sig-paren">(</span><em>sim</em>, <em>func=None</em>, <em>header=''</em>, <em>f=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='utf-8'&gt;</em>, <em>logging_interval=10</em>, <em>np_array_to_str=&lt;function np_array_to_str&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a simulation logger. Multiple loggers (each with their own file) can be used if desired.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sim</strong> (<a class="reference internal" href="#AIMM_simulator.Sim" title="AIMM_simulator.Sim"><em>Sim</em></a>) – The Sim instance which will manage this Logger.</li>
<li><strong>func</strong> (<em>function</em>) – Function called to perform logginf action.</li>
<li><strong>header</strong> (<em>str</em>) – Arbitrary text to write to the top of the logfile.</li>
<li><strong>f</strong> (<em>file object</em>) – An open file object which will be written or appended to.</li>
<li><strong>logging_interval</strong> (<em>float</em>) – Time interval between logging actions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="AIMM_simulator.Logger.finalize">
<code class="descname">finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Logger.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Function called at end of simulation, to implement any required finalization actions.</p>
</dd></dl>

<dl class="method">
<dt id="AIMM_simulator.Logger.loop">
<code class="descname">loop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#AIMM_simulator.Logger.loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Main loop of Logger class.
Can be overridden to provide custom functionality.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-NR_5G_standard_functions">
<span id="nr-5g-standard-functions"></span><h3>NR 5G standard functions<a class="headerlink" href="#module-NR_5G_standard_functions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="NR_5G_standard_functions.RSRP_report">
<code class="descclassname">NR_5G_standard_functions.</code><code class="descname">RSRP_report</code><span class="sig-paren">(</span><em>rsrp_dBm</em><span class="sig-paren">)</span><a class="headerlink" href="#NR_5G_standard_functions.RSRP_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert RSRP report from dBm to standard range.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rsrp_dBm</strong> (<em>float</em>) – RSRP report in dBm</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">RSRP report in standard range.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="NR_5G_standard_functions.Radio_state">
<em class="property">class </em><code class="descclassname">NR_5G_standard_functions.</code><code class="descname">Radio_state</code><span class="sig-paren">(</span><em>NofSlotsPerRadioFrame: int = 20</em>, <em>NofRadioFramePerSec: int = 100</em>, <em>NRB_sc: int = 12</em>, <em>Nsh_symb: int = 13</em>, <em>NPRB_oh: int = 0</em>, <em>nPRB: int = 273</em>, <em>Qm: int = 8</em>, <em>v: int = 4</em>, <em>R: float = 0.948</em>, <em>MCS: int = 20</em><span class="sig-paren">)</span><a class="headerlink" href="#NR_5G_standard_functions.Radio_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="uma-pathloss-model">
<h3>UMa pathloss model<a class="headerlink" href="#uma-pathloss-model" title="Permalink to this headline">¶</a></h3>
<p>Urban macrocell dual-slope pathloss model, from 3GPP standard 36.873.</p>
<span class="target" id="module-UMa_pathloss_model"></span><dl class="class">
<dt id="UMa_pathloss_model.UMa_pathloss">
<em class="property">class </em><code class="descclassname">UMa_pathloss_model.</code><code class="descname">UMa_pathloss</code><span class="sig-paren">(</span><em>fc_GHz=3.5</em>, <em>h_UT=2.0</em>, <em>h_BS=25.0</em>, <em>LOS=True</em>, <em>h=20.0</em>, <em>W=20.0</em><span class="sig-paren">)</span><a class="headerlink" href="#UMa_pathloss_model.UMa_pathloss" title="Permalink to this definition">¶</a></dt>
<dd><p>Urban macrocell dual-slope pathloss model, from 3GPP standard 36.873,
Table 7.2-1.</p>
<p>The model is defined in 36873-c70.doc from <a class="reference external" href="https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=2574">https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=2574</a>.</p>
<p>This code covers the cases 3D-UMa LOS and NLOS.
3D-UMa = three dimensional urban macrocell model.
LOS    = line-of-sight.
NLOS   = non-line-of-sight.</p>
<dl class="method">
<dt id="UMa_pathloss_model.UMa_pathloss.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>xyz_cell</em>, <em>xyz_UE</em><span class="sig-paren">)</span><a class="headerlink" href="#UMa_pathloss_model.UMa_pathloss.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pathloss between 3-dimensional positions xyz_cell and
xyz_UE (in metres).
Note that the distances, building heights, etc. are not checked
to ensure that this pathloss model is actually applicable.</p>
</dd></dl>

<dl class="method">
<dt id="UMa_pathloss_model.UMa_pathloss.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>fc_GHz=3.5</em>, <em>h_UT=2.0</em>, <em>h_BS=25.0</em>, <em>LOS=True</em>, <em>h=20.0</em>, <em>W=20.0</em><span class="sig-paren">)</span><a class="headerlink" href="#UMa_pathloss_model.UMa_pathloss.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a pathloss model instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fc_GHz</strong> (<em>float</em>) – Centre frequency in GigaHertz (default 3.5).</li>
<li><strong>h_UT</strong> (<em>float</em>) – Height of User Terminal (=UE) in metres  (default 2).</li>
<li><strong>h_BS</strong> (<em>float</em>) – Height of Base Station in metres (default 25).</li>
<li><strong>LOS</strong> (<em>bool</em>) – Whether line-of-sight model is to be used (default True).</li>
<li><strong>h</strong> (<em>float</em>) – Average building height (default 20, used in NLOS case only)</li>
<li><strong>W</strong> (<em>float</em>) – Street width (default 20, used in NLOS case only)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="UMa_pathloss_model.plot">
<code class="descclassname">UMa_pathloss_model.</code><code class="descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#UMa_pathloss_model.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the pathloss model predictions, as a self-test.</p>
</dd></dl>

</div>
<div class="section" id="umi-pathloss-model">
<h3>UMi pathloss model<a class="headerlink" href="#umi-pathloss-model" title="Permalink to this headline">¶</a></h3>
<p>Urban microcell street-canyon pathloss model, from 3GPP standard 36.873.</p>
<span class="target" id="module-UMi_pathloss_model"></span><dl class="class">
<dt id="UMi_pathloss_model.UMi_streetcanyon_pathloss">
<em class="property">class </em><code class="descclassname">UMi_pathloss_model.</code><code class="descname">UMi_streetcanyon_pathloss</code><span class="sig-paren">(</span><em>fc_GHz=3.5</em>, <em>h_UT=2.0</em>, <em>h_BS=10.0</em>, <em>LOS=True</em><span class="sig-paren">)</span><a class="headerlink" href="#UMi_pathloss_model.UMi_streetcanyon_pathloss" title="Permalink to this definition">¶</a></dt>
<dd><p>Urban microcell dual-slope pathloss model, from 3GPP standard 36.873,
Table 7.2-1.
The model is defined in 36873-c70.doc from <a class="reference external" href="https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=2574">https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=2574</a>.
This code covers the cases 3D-UMi LOS and NLOS.
3D-UMi = three-dimensional urban street canyon model.
LOS    = line-of-sight.
NLOS   = non-line-of-sight.</p>
<dl class="method">
<dt id="UMi_pathloss_model.UMi_streetcanyon_pathloss.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>xyz_cell</em>, <em>xyz_UE</em><span class="sig-paren">)</span><a class="headerlink" href="#UMi_pathloss_model.UMi_streetcanyon_pathloss.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pathloss between 3-dimensional positions xyz_cell and
xyz_UE (in metres).
Note that the distances, building heights, etc. are not checked
to ensure that this pathloss model is actually applicable.</p>
</dd></dl>

<dl class="method">
<dt id="UMi_pathloss_model.UMi_streetcanyon_pathloss.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>fc_GHz=3.5</em>, <em>h_UT=2.0</em>, <em>h_BS=10.0</em>, <em>LOS=True</em><span class="sig-paren">)</span><a class="headerlink" href="#UMi_pathloss_model.UMi_streetcanyon_pathloss.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a pathloss model instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fc_GHz</strong> (<em>float</em>) – Centre frequency in GigaHertz (default 3.5).</li>
<li><strong>h_UT</strong> (<em>float</em>) – Height of User Terminal (=UE) in metres  (default 2).</li>
<li><strong>h_BS</strong> (<em>float</em>) – Height of Base Station in metres (default 10 for UMi).</li>
<li><strong>LOS</strong> (<em>bool</em>) – Whether line-of-sight model is to be used (default True).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="UMi_pathloss_model.plot">
<code class="descclassname">UMi_pathloss_model.</code><code class="descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#UMi_pathloss_model.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the pathloss model predictions, as a self-test.</p>
</dd></dl>

</div>
<div class="section" id="inh-pathloss-model">
<h3>InH pathloss model<a class="headerlink" href="#inh-pathloss-model" title="Permalink to this headline">¶</a></h3>
<p>3D-InH indoor pathloss model, from 3GPP standard 36.873.</p>
<span class="target" id="module-InH_pathloss_model"></span><dl class="class">
<dt id="InH_pathloss_model.InH_pathloss">
<em class="property">class </em><code class="descclassname">InH_pathloss_model.</code><code class="descname">InH_pathloss</code><span class="sig-paren">(</span><em>fc_GHz=3.5</em>, <em>h_UT=2.0</em>, <em>h_BS=4.0</em>, <em>LOS=True</em><span class="sig-paren">)</span><a class="headerlink" href="#InH_pathloss_model.InH_pathloss" title="Permalink to this definition">¶</a></dt>
<dd><p>3D-InH indoor pathloss model, from 3GPP standard 36.873, Table 7.2-1.
Indoor Hotspot cell with high (indoor) UE density.</p>
<p>The model is defined in 36873-c70.doc from <a class="reference external" href="https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=2574">https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=2574</a>.</p>
<p>LOS    = line-of-sight.
NLOS   = non-line-of-sight.</p>
<dl class="method">
<dt id="InH_pathloss_model.InH_pathloss.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>xyz_cell</em>, <em>xyz_UE</em><span class="sig-paren">)</span><a class="headerlink" href="#InH_pathloss_model.InH_pathloss.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pathloss between 3-dimensional positions xyz_cell and
xyz_UE (in metres).
Note that the distances, heights, etc. are not checked
to ensure that this pathloss model is actually applicable.</p>
</dd></dl>

<dl class="method">
<dt id="InH_pathloss_model.InH_pathloss.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>fc_GHz=3.5</em>, <em>h_UT=2.0</em>, <em>h_BS=4.0</em>, <em>LOS=True</em><span class="sig-paren">)</span><a class="headerlink" href="#InH_pathloss_model.InH_pathloss.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a pathloss model instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fc_GHz</strong> (<em>float</em>) – Centre frequency in GigaHertz (default 3.5).</li>
<li><strong>h_UT</strong> (<em>float</em>) – Height of User Terminal (=UE) in metres (default 2).</li>
<li><strong>h_BS</strong> (<em>float</em>) – Height of Base Station in metres (default 25).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="InH_pathloss_model.plot">
<code class="descclassname">InH_pathloss_model.</code><code class="descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#InH_pathloss_model.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the pathloss model predictions, as a self-test.</p>
</dd></dl>

</div>
<div class="section" id="module-geometry_3d">
<span id="geometry-3d-module"></span><h3>geometry_3d module<a class="headerlink" href="#module-geometry_3d" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="geometry_3d.Building">
<em class="property">class </em><code class="descclassname">geometry_3d.</code><code class="descname">Building</code><span class="sig-paren">(</span><em>panels</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.Building" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a collection of panels making up a building.</p>
</dd></dl>

<dl class="class">
<dt id="geometry_3d.Panel">
<em class="property">class </em><code class="descclassname">geometry_3d.</code><code class="descname">Panel</code><span class="sig-paren">(</span><em>triangles</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.Panel" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a collection of triangles (which must be parallel) making up a single flat wall panel.</p>
</dd></dl>

<dl class="class">
<dt id="geometry_3d.Plane">
<em class="property">class </em><code class="descclassname">geometry_3d.</code><code class="descname">Plane</code><span class="sig-paren">(</span><em>point</em>, <em>normal</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.Plane" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents an infinite plane, defined by a point on the plane and a normal vector</p>
</dd></dl>

<dl class="class">
<dt id="geometry_3d.RIS">
<em class="property">class </em><code class="descclassname">geometry_3d.</code><code class="descname">RIS</code><span class="sig-paren">(</span><em>panel</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.RIS" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO a RIS.</p>
</dd></dl>

<dl class="class">
<dt id="geometry_3d.Ray">
<em class="property">class </em><code class="descclassname">geometry_3d.</code><code class="descname">Ray</code><span class="sig-paren">(</span><em>tail</em>, <em>dv</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.Ray" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a ray, defined by a tail (starting point) and a direction vector</p>
<dl class="method">
<dt id="geometry_3d.Ray.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax</em>, <em>length=1.0</em>, <em>color='b'</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.Ray.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the ray in 3d</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="geometry_3d.Triangle">
<em class="property">class </em><code class="descclassname">geometry_3d.</code><code class="descname">Triangle</code><span class="sig-paren">(</span><em>p0</em>, <em>p1</em>, <em>p2</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.Triangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a planar triangle in 3d space, defined by three points.  Unoriented.</p>
<dl class="method">
<dt id="geometry_3d.Triangle.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>ax</em>, <em>color='y'</em>, <em>alpha=0.5</em>, <em>drawedges=True</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.Triangle.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the triangle in 3d. For kwargs, see <a class="reference external" href="https://matplotlib.org/stable/api/collections_api.html#matplotlib.collections.Collection">https://matplotlib.org/stable/api/collections_api.html#matplotlib.collections.Collection</a></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="geometry_3d.block">
<code class="descclassname">geometry_3d.</code><code class="descname">block</code><span class="sig-paren">(</span><em>c0</em>, <em>c1</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.block" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a rectangular block with opposite corners c0 and c1, with each face a rectangular Panel</p>
</dd></dl>

<dl class="function">
<dt id="geometry_3d.cube">
<code class="descclassname">geometry_3d.</code><code class="descname">cube</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c=(0.0</em>, <em>0.0</em>, <em>0.0)</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.cube" title="Permalink to this definition">¶</a></dt>
<dd><p>cube c+[a,b]x[a,b]x[a,b], with each face a square Panel of two Triangles</p>
</dd></dl>

<dl class="function">
<dt id="geometry_3d.draw_building_3d">
<code class="descclassname">geometry_3d.</code><code class="descname">draw_building_3d</code><span class="sig-paren">(</span><em>building, rays=[], line_segments=[], dots=[], color='y', fontsize=6, limits=[(0, 10), (0, 10), (0, 5)], labels=['', '', ''], drawedges=True, show=True, pdffn='', pngfn='', dbg=False</em><span class="sig-paren">)</span><a class="headerlink" href="#geometry_3d.draw_building_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>General function to draw a building, also rays and lines.</p>
</dd></dl>

<p>Last modified: 2022-11-14T10:53</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">AIMM simulator documentation</a><ul>
<li><a class="reference internal" href="#purpose">Purpose</a></li>
<li><a class="reference internal" href="#software-prerequisites">Software prerequisites</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#quick-start">Quick start</a></li>
<li><a class="reference internal" href="#aimm-simulator-blocks">AIMM simulator blocks</a></li>
<li><a class="reference internal" href="#tutorial-examples">Tutorial examples</a><ul>
<li><a class="reference internal" href="#example-1">Example 1</a></li>
<li><a class="reference internal" href="#example-2-adding-a-scenario">Example 2 - adding a scenario</a></li>
<li><a class="reference internal" href="#example-3-adding-a-custom-logger">Example 3 - adding a custom logger</a></li>
<li><a class="reference internal" href="#example-4-adding-a-ric">Example 4 - adding a RIC</a></li>
<li><a class="reference internal" href="#example-5-adding-an-antenna-radiation-pattern">Example 5 - adding an antenna radiation pattern</a></li>
<li><a class="reference internal" href="#example-6-a-hetnet-heterogeneous-network-with-macro-and-small-cells">Example 6 - a hetnet (heterogeneous network) with macro and small cells</a></li>
<li><a class="reference internal" href="#example-7-a-hetnet-with-mobility">Example 7 - a hetnet with mobility</a></li>
<li><a class="reference internal" href="#example-8-estimating-cqi-distribution">Example 8 - estimating CQI distribution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-geometry-3d-module">Using the geometry_3d module</a></li>
<li><a class="reference internal" href="#using-the-real-time-plotting-utility">Using the real-time plotting utility</a></li>
<li><a class="reference internal" href="#simulator-module-api-reference">Simulator module API reference</a><ul>
<li><a class="reference internal" href="#module-AIMM_simulator">AIMM simulator</a></li>
<li><a class="reference internal" href="#module-NR_5G_standard_functions">NR 5G standard functions</a></li>
<li><a class="reference internal" href="#uma-pathloss-model">UMa pathloss model</a></li>
<li><a class="reference internal" href="#umi-pathloss-model">UMi pathloss model</a></li>
<li><a class="reference internal" href="#inh-pathloss-model">InH pathloss model</a></li>
<li><a class="reference internal" href="#module-geometry_3d">geometry_3d module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">AIMM simulator 2.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Keith Briggs.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>